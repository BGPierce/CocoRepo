/* BEAMSUBS.C  Subrs for Beam() *//* 98/3/15 Added subs for KeyPad *//* #include <stdio.h> */#include "wmuse.h"#include "wcodes.h"#include "vmem.h"#include "macros.h"#include "screen.h"#include "windows.h"#include "fcnptrs.h"#define Print  (*pprintf)#define Write  (*pnfwrite)extern direct sexy     curcurse,     numer, denom, nzones, dencodur, nstaves, nparts;extern direct Deltime     dendur, zonedur;extern direct bool     tripper, thick;extern STAFF   staves[];extern CLEF    clefs[];extern PART    parts[];extern ubyte   grafxes[], grafyes[];extern direct char  *pct7, *pctn1, *pctn2;/* "ArgBox" for faster piping to Fran.*  These MUST be kept contiguous and in order! */extern direct ubyte     arg0, arg1, arg2, arg3, arg4, arg5, arg6, arg7;/* Crap needed to force RLINK to link in pfdat347.r */extern char pfdat1[];char *pfdum() {   /* Just to link in pfdat stuff */     return(pfdat1);}/* Tests for any type of Barline; == testbar(evp, FALSE) */bool anybar(evp)  EVENT *evp;{    return( (!evp->part) && (evp->show.INCTYPE <= FINE) );}vline(x, y1, y2, c)  int     x;  sexy    y1, y2, c;{/*   printf(pct6, VLIN, *((char *)&x), x, y1, y2, c); */     arg0 = VLIN;     arg1 = *((char *) &x);     arg2 = x;     arg3 = y1;     arg4 = y2;     arg5 = c;     Write(6);} /* vline() *//* The beam-line starter main fcn.  Also slips "thick" to Fran. */bline(x1, y1, x2, y2)  int     x1, x2;  sexy    y1, y2;{     arg0 = BLINE;     arg1 = *((char *) &x1);     arg2 = x1;     arg3 = y1;     arg4 = *((char *) &x2);     arg5 = x2;     arg6 = y2;     arg7 = thick;     Write(8);} /* bline() *//* Repeat the full barline of above, up or down by 'ydel' */bagnline(ydel)  sexy    ydel;{     arg0 = BAGNL;     arg1 = ydel;     Write(2);}/* Repeat a piece of above, by ydel, from xs to xe */bsegline(ydel, xs, xe)  sexy    ydel;  int     xs, xe;{     arg0 = BSEGL;     arg1 = ydel;     arg2 = *((char *) &xs);     arg3 = xs;     arg4 = *((char *) &xe);     arg5 = xe;     Write(6);} /* bsegline() */bool timesig(){     switch(denom) {     case 2:  dencodur = 2;   break;     case 4:  dencodur = 3;   break;     case 8:  dencodur = 4;   break;     case 16: dencodur = 5;   break;     default: return(FALSE);  /* Invalid denom */     }     dendur = 192 / denom;     tripper = (dencodur >= 4) && (numer >= 6) && !(numer % 3);     if(tripper) {          zonedur = 3 * dendur;          nzones = numer / 3;     }     else {          nzones = numer;          zonedur = dendur;     }     return(TRUE);   /* Valid denom */} /* timesig() *//*** Open a Pat & Vanna overlay window ***/wcreate(leftcol, topy, colswide, rowshigh, dosave, style)  sexy    leftcol, topy, colswide, rowshigh, style;  bool    dosave;{     Print(pct7, OWST, leftcol, topy, colswide, rowshigh, dosave, style);}/*** Close above window type ***/wkill() {     Print(pctn1, OWEN);}void showstaff(part, sty, /* lownote, */ hilo)  sexy  part;       /* INput; rest are OUTputs: */  short *sty;       /* staffY */  sexy  *hilo;      /* indicators */{    register PART   *ptptr;    if((part < 1) || (part > nparts))        part = nparts;     *hilo =  (ptptr = parts + part) -> philo;    *sty =  staves[ptptr->pstaff].staffY;}/* eof beamsubs.c */