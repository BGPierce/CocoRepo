PROCEDURE KISSDrawFill(* Procedure to fill an area of the(* screen with a pattern selected(* with the high resolution mouseTYPE rodent=Vld,Act,ToTm:BYTE; X1:INTEGER; TTTo:BYTE; TSSt:INTEGER
; CBSA,CBSB,CCtA,CCtB,TTSA,TTSB,TLSA,TLSB:BYTE; X2,BDX,BDY:INTEGER
; Stat,Res:BYTE; AcX,AcY,WRX,WRY:INTEGERTYPE stats=IsEvent,InWindow,InToolBox,InMenuBar,line,box,circle,
ellipse,bar,arc,fill,text,freehand,RecordOn:BOOLEANTYPE cursor=OutPut,Scale,ScreenType,NoCur,arrow,pencil,cross,hourglass
,NoIcon,TextBar,Scross,Icon,IconBuff,pattern,horzline,vertline,slantright
,slantleft,dots:BYTETYPE codes=DArc,DBar,DBox,DCircle,DEllipse,DLine,DPoint,DFill,DSetPtr
,DPutCur,DSetCur,DLogic,DPattern:INTEGERTYPE object=DCode,HorP,VerP:INTEGERTYPE orgin=DPSCode,HanX,HanYTYPE packet=mouse:rodent; status:stats; pointer:cursor; Code:codes
; Pen:object; Handle:orginPARAM Event:packetDIM pointers,patternset:BOOLEANpatternset:=FALSEpointers:=FALSE(* First, we must select the pattern we want to fill with(* This means we must point to itWHILE NOT(patternset) DO REPEAT RUN getKISSMouse(Event)IF Event.mouse.AcX<40 THEN pointers:=TRUERUN gfx2("GCSet",Event.pointer.IconBuff,Event.pointer.arrow)ELSE pointers:=FALSERUN gfx2("GCSet",Event.pointer.IconBuff,Event.pointer.NoIcon)ENDIF UNTIL Event.mouse.CBSA<>0 OR Event.mouse.CCtA<>0IF pointers THEN IF Event.mouse.AcY>118 AND Event.mouse.AcY<130 THEN RUN gfx2("Pattern",204,8) \patternset:=TRUE \REM Large DotsELSE IF Event.mouse.AcY>130 AND Event.mouse.AcY<142 THEN RUN gfx2("Pattern",204,3) \patternset:=TRUE \REM Horizontal linesELSE IF Event.mouse.AcY>142 AND Event.mouse.AcY<154 THEN RUN gfx2("Pattern",204,2) \patternset:=TRUE \REM Vertical linesELSE IF Event.mouse.AcY>154 AND Event.mouse.AcY<166 THEN RUN gfx2("Pattern",204,6) \patternset:=TRUE \REM Right Slanted LinesELSE IF Event.mouse.AcY>166 THEN RUN gfx2("Pattern",204,5) \patternset:=TRUE \REM Left Slanted LinesELSE RUN gfx2("Pattern",0,0) \REM make sure pattern is solidpatternset:=FALSEENDIF ENDIF ENDIF ENDIF ENDIF ENDIF ENDWHILE (* We have the pattern now(* Let's do actual fillREPEAT RUN getKISSMouse(Event)IF Event.mouse.AcX<40 OR Event.mouse.AcY<10 THEN RUN gfx2("GCSet",Event.pointer.IconBuff,Event.pointer.arrow)ELSE RUN gfx2("GCSet",Event.pointer.IconBuff,Event.pointer.Scross)ENDIF UNTIL Event.mouse.CBSA<>0 AND Event.mouse.AcX>40Event.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=Event.mouse.AcXEvent.Pen.VerP:=Event.mouse.AcYPUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DFillEvent.Pen.HorP:=0Event.Pen.VerP:=0PUT #1,Event.PenREM We must always reset to solid patternRUN gfx2("Pattern",Event.pointer.NoCur,Event.pointer.NoCur)END 