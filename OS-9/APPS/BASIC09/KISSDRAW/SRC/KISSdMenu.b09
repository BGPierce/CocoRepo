PROCEDURE KISSdMenu(* Procedure to draw 'tools' menu bar on screen TYPE rodent=Vld,Act,ToTm:BYTE; X1:INTEGER; TTTo:BYTE; TSSt:INTEGER; CBSA,CBSB,CCtA,CCtB,TTSA,TTSB,TLSA,TLSB:BYTE; X2,BDX,BDY:INTEGER; Stat,Res:BYTE; AcX,AcY,WRX,WRY:INTEGERTYPE stats=IsEvent,InWindow,InToolBox,InMenuBar,line,box,circle,ellipse,bar,arc,fill,text,freehand,RecordOn:BOOLEANTYPE cursor=OutPut,Scale,ScreenType,NoCur,arrow,pencil,cross,hourglass,NoIcon,TextBar,Scross,Icon,IconBuff,pattern,horzline,vertline,slantright,slantleft,dots:BYTETYPE codes=DArc,DBar,DBox,DCircle,DEllipse,DLine,DPoint,DFill,DSetPtr,DPutCur,DSetCur,DLogic,DPattern:INTEGERTYPE object=DCode,HorP,VerP:INTEGERTYPE orgin=DPSCode,HanX,HanYTYPE packet=mouse:rodent; status:stats; pointer:cursor; Code:codes; Pen:object; Handle:orginPARAM Event:packetDIM vert:INTEGERRUN gfx2("pattern",0,0)RUN gfx2("logic","off")(* We'll draw an outline of the menu bar firstEvent.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=10Event.Pen.VerP:=10PUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DBoxEvent.Pen.HorP:=40Event.Pen.VerP:=178PUT #1,Event.Pen(* Now we need to fill in the individual boxesFOR vert=22 TO 178 STEP 12Event.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=10Event.Pen.VerP:=vertPUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DLineEvent.Pen.HorP:=40Event.Pen.VerP:=vertPUT #1,Event.PenNEXT vert(* Now we'll add the icons(* First, an Icon that means 'Draw a Line'Event.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=12Event.Pen.VerP:=20PUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DLineEvent.Pen.HorP:=38Event.Pen.VerP:=12PUT #1,Event.Pen(* Now an Icon for a BoxEvent.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=14Event.Pen.VerP:=24PUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DBoxEvent.Pen.HorP:=36Event.Pen.VerP:=32PUT #1,Event.Pen(* A Circle is our next IconEvent.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=25Event.Pen.VerP:=40PUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DCircleEvent.Pen.HorP:=8Event.Pen.VerP:=0PUT #1,Event.Pen(* Now we need an icon for an ellipseEvent.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=25Event.Pen.VerP:=52PUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DEllipseEvent.Pen.HorP:=12Event.Pen.VerP:=3PUT #1,Event.Pen(* Now, an icon for a BarEvent.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=14Event.Pen.VerP:=61PUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DBarEvent.Pen.HorP:=36Event.Pen.VerP:=67PUT #1,Event.Pen(* An Icon for an Arc is nextRUN gfx2("arc",25,76,7,4,-14,-8,18,14)(* Now we'll fake a spray canRUN gfx2("box",21,86,29,93)RUN gfx2("bar",24,84,26,86)RUN gfx2("line",26,84,34,82)RUN gfx2("line",26,84,38,84)RUN gfx2("line",26,84,34,85)(* We'll let the Letter 'T' be an icon(* to represent typing textRUN gfx2("curxy",3,12)PRINT "T"; (* For a freehand icon, we'll use two (* crossed arcsRUN gfx2("arc",20,114,7,4,-14,-8,18,4)RUN gfx2("arc",30,110,7,4,14,8,-18,-4)(* Now we'll give you five fill(* patterns to choose from(* Large Dots FirstRUN gfx2("pattern",204,8)RUN gfx2("fill",25,125)(* Followed by horizontal linesRUN gfx2("pattern",204,3)RUN gfx2("fill",25,135)(* Now we'll use vertical linesRUN gfx2("pattern",204,2)RUN gfx2("fill",25,146)(* and left slanted linesRUN gfx2("pattern",204,5)RUN gfx2("fill",25,156)(* and finally right slanted linesRUN gfx2("pattern",204,6)RUN gfx2("fill",25,172)(* You must always return to a solid pattern(* before you try to draw againRUN gfx2("pattern",0,0)(* Now we'll draw a menu bar across the top of the screen(* Initially, we'll only put a 'file' menu on it.Event.Pen.DCode:=Event.Code.DSetPtrEvent.Pen.HorP:=0Event.Pen.VerP:=0PUT #1,Event.PenEvent.Pen.DCode:=Event.Code.DBarEvent.Pen.HorP:=639Event.Pen.VerP:=8PUT #1,Event.PenRUN gfx2("curxy",10,0)RUN gfx2("revon")PRINT "File "; RUN gfx2("revoff")end