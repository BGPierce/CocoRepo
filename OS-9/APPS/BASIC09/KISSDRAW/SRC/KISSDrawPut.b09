PROCEDURE KISSDrawPut(* Drawing program For the Color Computer IIITYPE rodent=Vld,Act,ToTm:BYTE; X1:INTEGER; TTTo:BYTE; TSSt:INTEGER
; CBSA,CBSB,CCtA,CCtB,TTSA,TTSB,TLSA,TLSB:BYTE; X2,BDX,BDY:INTEGER
; Stat,Res:BYTE; AcX,AcY,WRX,WRY:INTEGERTYPE stats=IsEvent,InWindow,InToolBox,InMenuBar,line,box,circle,
ellipse,bar,arc,fill,text,freehand,RecordOn:BOOLEANTYPE cursor=OutPut,Scale,ScreenType,NoCur,arrow,pencil,cross,hourglass
,NoIcon,TextBar,Scross,Icon,IconBuff,pattern,horzline,vertline,slantright
,slantleft,dots:BYTETYPE codes=DArc,DBar,DBox,DCircle,DEllipse,DLine,DPoint,DFill,DSetPtr
,DPutCur,DSetCur,DLogic,DPattern:INTEGERTYPE object=DCode,HorP,VerP:INTEGERTYPE orgin=DPSCode,HanX,HanY:INTEGERTYPE packet=mouse:rodent; status:stats; pointer:cursor; Code:codes
; Pen:object; Handle:orginTYPE Drawing=Loc:orgin; tool:objectDIM Event:packetDIM MaxObjects,ObjNum:INTEGERDIM PixFile:BYTEDIM Picture(20):DrawingDIM char:STRING[1]MaxObjects:=20FOR ObjNum:=1 TO MaxObjectsPicture(ObjNum).Loc.DPSCode:=0Picture(ObjNum).Loc.HanX:=0Picture(ObjNum).Loc.HanY:=0Picture(ObjNum).tool.DCode:=0Picture(ObjNum).tool.HorP:=0Picture(ObjNum).tool.VerP:=0NEXT ObjNumObjNum:=1char:=""Event.status.RecordOn:=FALSEEvent.Code.DSetCur:=$1B39Event.Code.DPutCur:=$1B4EEvent.Code.DSetPtr:=$1B40Event.Handle.DPSCode:=Event.Code.DSetPtrEvent.Code.DBox:=$1B48Event.Code.DBar:=$1B4AEvent.Code.DCircle:=$1B50Event.Code.DEllipse:=$1B51Event.Code.DFill:=$1B4FEvent.Code.DLine:=$1B44Event.Code.DArc:=$1B52Event.pointer.OutPut:=1Event.status.IsEvent:=FALSEEvent.status.line:=FALSEEvent.status.box:=FALSEEvent.status.circle:=FALSEEvent.status.ellipse:=FALSEEvent.status.bar:=FALSEEvent.status.arc:=FALSEEvent.status.fill:=FALSEEvent.status.text:=FALSEEvent.status.freehand:=FALSEEvent.pointer.NoCur=0Event.pointer.arrow=1Event.pointer.pencil=2Event.pointer.cross=3Event.pointer.hourglass=4Event.pointer.NoIcon=5Event.pointer.TextBar=6Event.pointer.Scross=7Event.pointer.IconBuff=202(* First we need to start with a clear screen(* and draw the menuRUN gfx2("Clear")RUN KISSdMenu(Event)(* We must bring the high resolution mouse on line(* and find out where it is pointingRUN setupmouseEvent.Pen.DCode:=Event.Code.DSetCurEvent.Pen.HorP:=INT(256*Event.pointer.IconBuff)+Event.pointer.arrowEvent.Pen.VerP:=0PUT #1,Event.PenLOOP  \REM Main Event LoopEXITIF char<>"" THEN ENDEXIT RUN inkey(char)RUN getKISSmouse(Event)(* Has there been an event (* Is Button DownIF Event.status.IsEvent THEN IF Event.status.InToolBox THEN RUN WhichTool(Event)Event.Pen.DCode:=Event.Code.DSetCurEvent.Pen.HorP:=256*Event.pointer.IconBuff+Event.pointer.pencilEvent.Pen.VerP:=0PUT #1,Event.PenRUN DoEvent(Event)REM Record Data Structure Picture here is Record Flag is ON.IF Event.status.RecordOn THEN IF ObjNum<=MaxObjects THEN Picture(ObjNum).Loc:=Event.HandlePicture(ObjNum).tool:=Event.PenObjNum:=ObjNum+1ENDIF ENDIF Event.Pen.DCode:=Event.Code.DSetCurEvent.Pen.HorP:=256*Event.pointer.IconBuff+Event.pointer.arrowEvent.Pen.VerP:=0PUT #1,Event.PenENDIF IF Event.status.InMenuBar THEN RUN HandleMenu(Event,Picture)ENDIF ENDIF ENDLOOP (* Turn Graphics Cursor off before leaving programEvent.Pen.DCode:=Event.Code.DSetCurEvent.Pen.HorP:=Event.pointer.NoCurEvent.Pen.VerP:=Event.pointer.NoCurPUT #1,Event.PenEND 