
2 CLS:PRINT"IF AN ERROR MESSAGE (?SN, ?NP ORSIMILAR) APPEARS BELOW, RUN THISPROGRAM AGAIN.  THE MESSAGE WILLNOT RECUR.  ERROR MESSAGE:":PRINT
4 PMODE0:PCLEAR1
6 CLS:SOUND255,1:CLEAR200,&H4000:PO=4:TW=2:J=63:K=31:QQ=&H4000:CLS:V=256:SS=&H6000
8 D$="LEAVE THIS STRING ALONE, PLEASE!"
10 U=VARPTR(D$):U=V*PEEK(U+2)+PEEK(U+3):DIMW(8):DIMP$(16):DIMD1(64),D2(64):DIMS(3,26):DATA96,64,65,66,67,68,69,70,71,82,91,93,107,109,112,113,,114,115,116,117,118,119,120,121,125,126
12 FORX=1TO26:READS(1,X):NEXT:FORX=1TO26:S(2,X)=X:NEXT
14 DATA0,1,3,4,6,8,9,11,0,0,0,1,-1,0,2,4,6,8,12,16,24,32,48,0,0,255
16 FORX=1TO26:READS(3,X):NEXT
18 PRINT@V," CLEARING MEMORY -- PLEASE WAIT":FORX=&H5000 TO &H5FFF:POKEX,0:NEXT
20 SQ=&H5000-4:SOUND255,1:CLS:PRINTSTRING$(32,"-");:PRINT" C O L O R  Q U A V E R  1.0":PRINT"    DENNIS BATHORY KITSZ":PRINTSTRING$(32,"-");'PRINT
22 PRINT"    <<<  O P T I O N S  >>>":PRINT
24 PRINT"   (1) BUILD WAVEFORM
26 PRINT"   (2) BUILD ENVELOPE
28 PRINT"   (3) SAVE WAVES/ENVELOPES
30 PRINT"   (4) ENTER OR EDIT MUSIC
32 PRINT"   (5) PLAY MUSIC
34 PRINT"   (6) LOAD FROM TAPE
36 PRINT"   (7) DISPLAY WAVEFORMS"
38 PRINT"   (8) DO SPECTRAL TRANSFORM"
40 PRINT"   TOUCH 1 - 8 FOR SELECTION.";
42 A$=INKEY$:IFA$<"1"ORA$>"8"THEN42
44 PRINT@224,"":PRINT:PRINT:PRINT:PRINT:PRINT:PRINT:PRINT
46 SOUND255,1:ONVAL(A$)GOTO48,58,68,78,140,180,212
48 I$="###### TIMBRE ASSIGNMENT #######":GOSUB444
50 CLS:PRINT@V,"WHICH VOICE TIMBRE? (TOUCH 1-4)
52 A$=INKEY$:IFA$=""OR A$<"1"ORA$>"4"THEN52
54 T=VAL(A$):IFW(T)=1THENPRINT@V," TIMBRE #"T"HAS BEEN ASSIGNED.":PRINT"  CHANGE IT?  (TOUCH Y OR N)"ELSE370
56 A$=0=INKEY$:IFA$="Y"ORA$="y"THEN370ELSEIFA$="N"ORA$="n"THEN20ELSE56
58 I$="##### ENVELOPE ASSIGNMENT #####":GOSUB444
60 CLS:PRINT@V,"WHICH ENVELOPE FORM? (TOUCH 1-4)
62 A$=INKEYS:IFA$=""ORA$<"1"ORA$>"4"THEN62
64 T=VAL(A$)+4:IFW(T)=1THENPRINT@V,"   ENVELOPE #"T-4"IS ASSIGNED.":PRINT"   CHANGE IT? (TOUCH Y OR N)":ELSE370
66 A$=INKEY$:IFA$="Y"ORA$="y"THEN370ELSEIFA$="N"ORA$="n"THEN20ELSE66
68 I$="###### SAVE ALL WAVEFORMS ######":GOSUB444
70 CLS:PRINT@V," INSERT CASSETTE IN RECORDER    PLACE IT IN RECORD MODE, AND    PRESS ENTER WHEN READY TO SAVE."
72 A$=INKEY$:IFA$<>CHR$(13)THEN72
74 CLS:PRINT@V,"PLEASE ENTER A FILENAME:":PRINT:INPUT"FILE NAME";A$:CSAVEM A$,&H4000,&H47FF,&H4900
76 GOTO20
78 I$="######### MUSIC EDITOR #########":GOSUB444
80 CLS:EE=1:EF=1:REM * SS ESTABLISHED AT BEGINNING OF PROGRAM AS &H6000
82 CLS:PRINT@V,"WHICH SCORE PAGE? (1 THROUGH 36)ENTER SCORE PAGE, OR ENTER ONLY TO START OR CONTINUE.":PRINT:PRINT"          ";:INPUTA$
84 IFA$=""THEN86ELSEIFA$="0"THEN20ELSEIFA$=<"1"THEN82ELSEIFVAL(A$)>36THEN82ELSESS=(VAL(A$)-1)*28+&H6000
86 CLS:FORX=1252TO1279:POKEX,PEEK(SS+X-1252):NEXT:FORX=1316TO1343:POKEX,PEEK(SS+X-1316+&H400):NEXTFORX=1380TO1407:POKEX,PEEK(SS+X-1380+&H800):NEXT:FORX=1444TO1471:POKEX,PEEK(SS+X-1444+&HC00):NEXT
88 EX=1024+V-93+EE*64+EF:EZ=PEEK(EX)
90 GOSUB108:EX=1024+V-93+EE*64+EF:POKEEX,140
92 A$=INKEY$:IFA$="^"THEN96ELSEIFA$=CHR$(10)THEN98ELSEIFA$=CHR$(8)THEN100ELSEIFA$=CHR$(9)THEN102ELSEIFA$=CHR$(13)THEN104ELSEIFA$=CHR$(21)THEN112
94 IFA$>="A"ANDA$<"H"ORA$>"0"ANDA$<":"ORA$="+"ORA$=">"THENPRINT@EX-1024,A$;:EZ=PEEK(EX):GOTO102:ELSE92
96 POKEEX,EZ:IFEE<2THEN90ELSEEE=EE-1:GOTO88
98 POKEEX,EZ:IFEE>3THEN90ELSEEE=EE+1:GOTO88
100 POKEEX,EZ:IFEF<2THEN90ELSEEF=EF-1:GOTO88
102 POKEEF,EZ:IFEF>27THEN90ELSEEF=EF+1:GOTO88
104 POKEEX,EZ:FORX=1252 TO 1279:POKESS,(PEEK(X)):POKEX,128:POKESS+&H400,PEEK(X+64):POKEX+64,128:POKESS+&H800,PEEK(X+128):POKEEX+128,128:POKESS+&HC00,PEEK(X+192):POKEEX+192,128:SS=SS+1:NEXT:GOTO80
106 GOTO106
108 PRINT@0,"USE CUSTOMARY NOTE NAMES (A-G). NATURAL (=)  SHARP(+)  FLAT (-)OCTAVES ARE 1-6.  MIDDLE C IS 3.FOR DURATION INFO, REFER TO YOURDOCUMENTATION.  SAMPLE FORMAT:  C+3@4 IS MIDDLE C#EIGHTH NOTE.":PRINT@V,"V1)";:PRINT@V+32,"V2)";
110 PRINT@V+96,"V3)";:PRINT@V+160,"V4)";:PRINT@484,"PAGE"(SS+28-&H6000)/28"OF SCORE";:RETURN
112 MM=0:CLS:I$=" SOURCE STORAGE AND COMPILATION ":GOSUB444
114 CLS:PRINT@V,"INSERT CASSETTE IN RECORDER AND PLACE IN RECORD MODE. ENTER FILENAME WHEN READY TO SAVE SOURCE.":PRINT:INPUT"        FILE NAME";A$
116 CSAVEM A$,&H6000,&H6FFF,&H47F0
