0 'COCODRAW V1.1 BY DARIN HERR1 GOTO32 CLS:PRINT@108,"COCODRAW":PRINT@142,"V1.1":PRINT@207,"BY":PRINT@235,"DARIN HERR":PRINT@270,"1986":PRINT@449,"INITIALIZING-ONE MOMENT PLEASE":GOTO53 PCLEAR8:GOTO25 DIM A(102),AR(1),ME(307),FI(151),SI(92),MI(191),GP(102),CH$(90):FORA=0TO90:READCH$(A):NEXT:BC=3:ES=7:PN=1:PM=1:LE=408 DIMD(15):FORA=0TO15:READD(A):NEXT10 PMODE4,5:COLOR0,1:PCLS20 LOADM"MENUS.SYS"600 GET(0,124)-(4,128),AR,G:GET(0,0)-(255,47),ME:GET(0,48)-(79,123),FI:GET(80,48)-(159,93),SI:GET(160,48)-(239,143),MI700 GOSUB8000710 GOSUB8500:SCREEN1,CS720 IFSP$=""THENLINE(56,84)-(197,117),PRESET,BF:LINE(57,85)-(196,116),PSET,B:DRAW"BM64,88":S$="Do you want to use":GOSUB10000:DRAW"BM64,97":S$="the Speed-Up POKE?":GOSUB10000:X=101:Y=106:GOSUB9800:IFA<32THENSP$="Y":GOTO1110ELSESP$="N":GOSUB8000730 GOSUB 9000740 PLAY"O3T16C":IFY>47THEN730750 IFY>32THENS=INT(X/64)+1:ONS GOTO1000,2000,2500,3000760 IFX>111THENS=X:GOTO3500770 X=INT(X/16)*16:Y=INT(Y/16)*16:S=(X/16+1)+7*Y/16:IFS=7ORS=14THEN780ELSEPUT(X+1,Y+1)-(X+15,Y+15),A,NOT780 ONS GOTO4000,4200,4400,4600,4800,5000,5200,5400,5600,4400,5800,6000,6200,64001000 GOSUB8200:PUT(0,48)-(79,123),FI:XX=0:N=6:GOSUB8800:POKE65494,0:IFS=7THEN1900ELSEIFS=3THENGOSUB8000:CLS:INPUT"DRIVE #";P:IFP>3THEN700ELSEDIRP:FORA=1TO2STEP0:IF(PEEK(&HFF00)OR&H80)<>&HFE THENNEXTELSE7001010 POKE178,0:POKE179,3:LINE(36,84)-(217,117),PRESET,BF:LINE(37,85)-(216,116),PSET,B:IFS=6THEN1690ELSEIFS<3THENS$="Disk"ELSES$="Tape"1020 IFS=1ORS=4THENS$=S$+" Load"ELSES$=S$+" Save"1030 DRAW"BM40,88":GOSUB10000:DRAW"BM40,97":S$="Filename:":GOSUB10000:IFS<3THENLE=14ELSELE=81040 X=110:Y=97:KE$="ALL":GOSUB11000:FI$=IN$1050 DRAW"BM40,106":S$="O.K.?":GOSUB10000:X=82:Y=106:GOSUB9800:IFA>31THEN11101060 IFS>3THEN10901070 IFS=1THENLOADMFI$ELSESAVEMFI$,3584,9727,445391080 GOTO11101090 IF S=4 THEN PMODE4,1:SCREEN1,CS:CLOADMFI$:PMODE4,5:SCREEN1,CS:GOTO11101100 CSAVEMFI$,3584,9727,445391110 GOSUB8000:IFSP$="Y"THENPOKE65495,01120 GOTO7301690 S$="Screen Dump":DRAW"BM87,88":GOSUB10000:S$="Is printer ready?":DRAW"BM67,97":GOSUB10000:X=99:Y=106:GOSUB9800:IFA>31THEN11101700 PRINT#-2,CHR$(27)"@"CHR$(27)"A"CHR$(8):S$=CHR$(27)+"K"+CHR$(128)+CHR$(1):FORA=1536TO1567:FORX=1TO2:PRINT#-2,S$;:FORB=191TO0STEP-1:P=NOT(PEEK(A+32*B)):IFX=1THENC=(P AND240)/16ELSEC=P AND151710 PRINT#-2,CHR$(D(C));CHR$(D(C));:NEXTB:PRINT#-2,CHR$(0):NEXTX,A:GOTO7001900 GOSUB8000:CLS:PRINT"TYPE 'CONT [ENTER]' TO RESTART  PROGRAM.":PRINT:STOP:GOTO7002000 GOSUB8200:PUT(64,48)-(143,93),SI:XX=64:N=3:GOSUB8800:IFS=1THENGOSUB8000:GOTO7302010 POKE178,0:POKE179,3:LINE(69,62)-(74,89),PRESET,BF:DRAW"BM69,"+STR$(S*10+42)+CH$(30):GET(64,48)-(143,93),SI:S=S-2:ES=S*4-SGN(S):GOTO7002500 GOSUB8200:PUT(128,48)-(207,143),MI:XX=128:N=8:GOSUB8800:IFS<5THENONS GOTO2510,2520,2540,2550ELSE25602510 GOSUB8000:LINE(0,48)-(255,191),PRESET,BF:GOTO7302520 GOSUB8000:PMODE4,1:SCREEN1,CS2530 GOSUB9400:IFFB<>&HFE THEN2530ELSEPMODE4,5:GOTO7002540 CS=ABS(CS-1):SCREEN1,CS:GOSUB8000:GOTO7302550 GOSUB8000:GOTO7302560 POKE178,0:POKE179,3:LINE(133,92)-(138,139),PRESET,BF:DRAW"BM133,"+STR$(S*10+42)+CH$(30):PM=S-4:GET(128,48)-(207,143),MI:GOSUB8000:GOTO7003000 GOSUB8000:GOTO7303500 GOSUB8200:PCLS:FORY=3TO191STEP12:FORX=3TO256STEP16:A=(Y-3)/12*16+(X-3)/16:POKE178,A:LINE(X,Y)-(X+7,Y+6),PSET,BF:IFINKEY$<>""THEN700ELSENEXTX,Y:IFBC=0THENPOKE178,3ELSEPOKE178,03510 X=INT(JOYSTK(0)/4)*16+2:Y=INT(JOYSTK(1)/4)*12+2:LINE(X,Y)-(X+9,Y+8),PSET,B:LINE(X,Y)-(X+9,Y+8),PRESET,B:FB=PEEK(&HFF00)OR&H80:I$=INKEY$:IFFB<>&HFE ANDI$=""THEN35103520 A=(Y-2)/12*16+(X-2)/16:IFI$<>""THEN700ELSEIFS<184THENFC=A ELSEBC=A3530 GOTO7004000 GOSUB9000:IFY<48THENGOSUB8500:GOTO740ELSEGOSUB8200:LINE(X,Y)-(X,Y),PRESET4010 GOSUB9400:LINE-(X,Y),PSET:IFFB=&HFE THEN4010ELSE40004200 GOSUB 8200:IFBC=0THENPOKE178,3ELSEPOKE178,04210 GOSUB9200:IFX>255-ES THENX=255-ES4220 IFY>191-ES THENY=191-ES4230 GET(X,Y)-(X+ES,Y+ES),A,G:LINE(X,Y)-(X+ES,Y+ES),PSET,BF:LINE(X,Y)-(X+ES,Y+ES),PRESET,BF:IFFB<>&HFE THENPUT(X,Y)-(X+ES,Y+ES),A,PSET4240 GOTO42104400 GOSUB9000:XX=X:YY=Y:IFY<48THENGOSUB8500:GOTO740ELSEGOSUB82004410 GOSUB9400:LINE(XX,YY)-(X,Y),PRESET,B:LINE-(XX,YY),PSET,B:IFFB=&HFE THENGOSUB8000:GOTO4410ELSEIFS>7THENLINE(XX,YY)-(X,Y),PSET,BF4420 GOTO44004600 GOSUB9000:XX=X:YY=Y:IFY<48THENGOSUB8500:GOTO740ELSEGOSUB82004610 GOSUB9400:CIRCLE(XX,YY),ABS(X+Y/12-8):IFFB=&HFE THENGOSUB8000:GOTO4610ELSE46004800 GOSUB9000:IFY<48THENGOSUB8500:GOTO740ELSEIFPPOINT(X,Y)=0THENC=1ELSEC=04810 GOSUB8200:PAINT(X,Y),,C:GOTO48005000 KE$="ALL":LE=365010 GOSUB9000:IFY<48THENPUT(81,1)-(95,15),A,NOT:GOTO740ELSEIFX=0THENX=15020 GOSUB8200:GOSUB11000:GOTO50105200 IFPN=1THEN730ELSEPUT(97,1)-(111,15),A,NOT:PUT(97,17)-(111,31),A,NOT:GOSUB8200:PN=1:GOSUB8000:GOTO7305400 GOSUB9000:IFY<48THENGOSUB8500:GOTO740ELSEGOSUB8200:XX=X:YY=Y5410 GOSUB8000:GOSUB9400:LINE(XX,YY)-(X,Y),PSET:IFFB=&HFE THEN5410ELSE54005600 GOSUB9000:IFY<48THENGOSUB8500:GOTO740ELSEXX=X:YY=Y:GOSUB82005610 GOSUB9400:LINE(XX,YY)-(X,Y),PSET:IFFB=&HFE THENA=0:GOTO5620ELSEGOSUB8000:GOTO56105620 A=A+1:GOSUB9400:IFFB=&HFE ANDA<10THEN5620ELSEIFA<10THENGOSUB8200:GOTO5610ELSE56305630 PLAY"C":GOSUB9400:IFFB=&HFE THEN5630ELSE56005800 GOSUB9000:IFY<48THENPUT(49,17)-(63,31),A,NOT:GOTO740ELSEGOSUB8200:XX=X:YY=Y5810 X=JOYSTK(0):Y=JOYSTK(1):IFXX+X>255THENX=255-XX5820 IFYY+Y>191THENY=191-YY5830 LINE(XX,YY)-(XX+X,YY+Y),PRESET,B:LINE-(XX,YY),PSET,B:FB=PEEK(&HFF00)OR&H80:GOSUB8000:IFFB=&HFE THEN5810ELSEGET(XX,YY)-(XX+X,YY+Y),GP,G:FORA=1TO4:PUT(XX,YY)-(XX+X,YY+Y),GP,NOT:NEXT:PUT(49,17)-(63,31),A,NOT:GX=X:GY=Y:GOTO7306000 GOSUB82006010 GOSUB9200:IFX+GX>255THENX=255-GX6020 GET(X,Y)-(X+GX,Y+GY),A,G:ONPM GOSUB6040,6050,6060,6070,6080:IFFB<>&HFE THENPUT(X,Y)-(X+GX,Y+GY),A,PSET6030 GOTO60106040 PUT(X,Y)-(X+GX,Y+GY),GP,PSET:RETURN6050 PUT(X,Y)-(X+GX,Y+GY),GP,PRESET:RETURN6060 PUT(X,Y)-(X+GX,Y+GY),GP,AND:RETURN6070 PUT(X,Y)-(X+GX,Y+GY),GP,OR:RETURN6080 PUT(X,Y)-(X+GX,Y+GY),GP,NOT:RETURN6200 POKE178,0:POKE179,36210 GOSUB9200:IFX>240THENX=2406220 IFY>176THENY=1766230 GET(X,Y)-(X+15,Y+15),A,G:LINE(X,Y)-(X+15,Y+15),PRESET,B:LINE(X,Y)-(X+15,Y+15),PSET,B:PUT(X,Y)-(X+15,Y+15),A,PSET:IFFB<>&HFE THEN6210ELSEGOSUB8200:X1=X:Y1=Y6240 SCREEN,0:PCLS:LINE(12,12)-(146,146),PSET,B:LINE(11,11)-(147,147),PSET,B:LINE(16,160)-(72,176),PSET,B:LINE(88,160)-(144,176),PSET,B:LINE(190,30)-(209,49),PSET,B:LINE(190,94)-(209,113),PSET,B:LINE(0,0)-(255,191),PSET,B:LINE(1,1)-(254,190),PSET,B6250 DRAW"BM57,3":S$="MAGNIFY":GOSUB10000:DRAW"BM31,165":S$="Done":GOSUB10000:DRAW"BM96,165":S$="Cancel":GOSUB10000:DRAW"BM181,56":S$="Before":GOSUB10000:DRAW"BM191,120":S$="Now":GOSUB100006260 PUT(192,32)-(207,47),A,PSET:PUT(192,96)-(207,111),A,PSET:FORY=32TO47:YY=(Y-32)*8+16:FORX=192TO207:XX=(X-192)*8+16:IFPPOINT(X,Y)=0THENLINE(XX,YY)-(XX+6,YY+6),PSET,BF ELSELINE(XX,YY)-(XX+6,YY+6),PRESET,BF6270 NEXTX,Y6280 GOSUB9000:IFX>142ORX<16ORY<16ORY>176THEN6280ELSEIFY<144THENX=INT((X-16)/8):Y=INT((Y-16)/8):XX=X*8+16:YY=Y*8+16:PUT(XX,YY)-(XX+6,YY+6),A,NOT:PUT(X+192,Y+96)-(X+192,Y+96),A,NOT:GOTO62806290 IFY<160ORY>176OR(X>93ANDX<88)THEN6280ELSEIFX>87THENGET(192,32)-(207,47),A,G:PUT(192,96)-(207,111),A,PSET:GOTO6260ELSEGET(192,96)-(207,111),A,G:GOSUB8500:GOSUB8000:PUT(X1,Y1)-(X1+15,Y1+15),A,PSET:X=80:Y=16:GOTO7706400 IFPN=2THEN730ELSEPUT(97,1)-(111,15),A,NOT:PUT(97,17)-(111,31),A,NOT:GOSUB8200:PN=2:GOSUB8000:GOTO7308000 FORP=PN TOPN+2:PCOPYP TOP+6-PN:NEXT:RETURN8200 FORP=6TO8:PCOPYP TOP-6+PN:NEXT:RETURN8500 PUT(0,0)-(255,47),ME:POKE178,FC:POKE179,BC:LINE(116,12)-(146,28),PSET,BF:DRAW"BM178,4NL24NG17ND24M157,13M178,4M169,26":LINE(188,13)-(250,27),PRESET,BF:IFPN=1THENPUT(97,1)-(111,15),A,NOT:RETURNELSEPUT(97,17)-(111,31),A,NOT:RETURN8800 GOSUB9400:S=INT(Y/3/(63/N)):GOTO88308810 GOSUB9400:S=INT(Y/3/(63/N)):IFFB<>&HFE THENS=S+1:PUT(XX+2,P*10+51)-(XX+76,P*10+60),A,NOT:RETURNELSEIFS=P THEN88108820 PUT(XX+2,P*10+51)-(XX+76,P*10+60),A,NOT8830 PUT(XX+2,S*10+51)-(XX+76,S*10+60),A,NOT:P=S:GOTO88109000 GOSUB9400:GOTO90209010 GOSUB9400:PUT(XX,YY)-(XX+4,YY+4),A,PSET:IFFB=&HFE THENRETURN9020 GET(X,Y)-(X+4,Y+4),A,G:IFPPOINT(X,Y)>0THENPUT(X,Y)-(X+4,Y+4),AR,PSET ELSEPUT(X,Y)-(X+4,Y+4),AR,PRESET9030 XX=X:YY=Y:GOTO90109200 GOSUB9400:IFY>47THENRETURNELSE92209210 GOSUB9400:PUT(XX,YY)-(XX+4,YY+4),A,PSET:IFY>47THENRETURN9220 GET(X,Y)-(X+4,Y+4),A,G:IFPPOINT(X,Y)>0THENPUT(X,Y)-(X+4,Y+4),AR,PSET ELSE PUT(X,Y)-(X+4,Y+4),AR,PRESET9230 IFFB=&HFE THENPUT(X,Y)-(X+4,Y+4),A,PSET:GOSUB8500:GOTO740ELSEXX=X:YY=Y:GOTO92109400 IFPEEK(&H155)+PEEK(&H156)+PEEK(&H157)+PEEK(&H158)<&H3F8 THENGOSUB95009410 X=JOYSTK(0)*4+XO:Y=JOYSTK(1)*3+YO:FB=PEEK(&HFF00)OR&H80:RETURN9500 IF(PEEK(341)=247ORPEEK(341)=246)ANDYO>0THENYO=YO-19510 IF(PEEK(342)=247ORPEEK(342)=246)ANDYO<2THENYO=YO+19520 IF(PEEK(343)=247ORPEEK(343)=246)ANDXO>0THENXO=XO-19530 IF(PEEK(344)=247ORPEEK(344)=246)ANDXO<3THENXO=XO+19540 FB=PEEK(&HFF00)OR&H80:IFFB=&HFE THENP=254ELSEP=2559550 FORA=&H155 TO&H158:POKEA,P:NEXT:RETURN9800 DRAW"BM"+STR$(X)+","+STR$(Y):S$="Yes   No":GOSUB100009810 A=JOYSTK(0):IFA<32THENPOKE178,0:POKE179,3ELSEPOKE178,3:POKE179,09820 LINE(X-1,Y+8)-(X+20,Y+8),PSET:LINE(X+40,Y+8)-(X+55,Y+8),PRESET:IF(PEEK(&HFF00)OR&H80)=&HFE THENPOKE178,FC:POKE179,BC:RETURNELSE981010000 FORA=1TOLEN(S$):DRAWCH$(ASC(MID$(S$,A,1))-32)+EX$:NEXT:RETURN11000 DRAW"BM"+STR$(X)+","+STR$(Y)+"LD8RU8RD8RU8RD8RU8RD8U8L5":GET(X-1,Y)-(X+5,Y+8),A,G:IN$=INKEY$11010 IN$=INKEY$:IFIN$=""ANDCO<10THENCO=CO+1:GOTO11010ELSEIFIN$=""THENPUT(X-1,Y)-(X+5,Y+8),A,NOT:CO=0:GOTO1101011020 IFIN$=CHR$(8)THENIFLEN(DE$)=0THEN11010ELSEPUT(X-1,Y)-(X+5,Y+8),A,PRESET:X=X-7:DE$=LEFT$(DE$,LEN(DE$)-1):DRAW"BL7":PUT(X-1,Y)-(X+5,Y+8),A,PSET:GOTO1101011030 IFIN$=CHR$(13)THENPUT(X-1,Y)-(X+5,Y+8),A,PRESET:IN$=DE$:DE$="":RETURN11040 IFASC(IN$)<31ORLEN(DE$)=LE ORIN$=CHR$(95)ORX>242 THEN1101011050 IFKE$<>"ALL"THENIFINSTR(KE$,IN$)=0THENSOUND1,1:GOTO1101011060 PUT(X-1,Y)-(X+5,Y+8),A,PRESET:DRAWCH$(ASC(IN$)-32):DE$=DE$+IN$:X=X+7:PUT(X-1,Y)-(X+5,Y+8),A,PSET:GOTO1101012000 DATA BR7,BR2D4BD2D0BU6BR5,BRDBR2UBR4,BD2R4HD4EL4FU4BUBR6,BR4BDL4D2R4D2L4R2DU6BR5,DRUBR3DG4DBR3URDBU6BR3,BRRFG3DFRE2BD2H4UBUBR7,BRDRUBR5,BR3G2D2F2BU6BR4,BRF2D2G2BU6BR6,BD3R4BD2H4BD4E4BUBR3,BD3R4BG2U4BUBR5,BD6BR2GBU7BR6,BD3R4BU3BR312010 DATA BD6BR2R0BU6BR5,BD6UE4UBR3,BDD4FR2EU4HL2BD3BRR0BE3BR2,BR2D6RL2BU5EBR5,BDER2FDG4R4BU6BR3,BDER2FDGL2R2FDGL2HBE5BR2,D3R4LD3U6BR4,R4L4D3R4D3L4BE6BR,BDD4FR2EUHL2BU3R2FBEBR2,DUR4D2G3DBE6,BDDFR2FDGL2HUER2EUHL2BR6,BRR2FD4GL2HBU4DFR3BE312020 DATA BD3BR2D0BD3U0BU6BR5,BD3BR2D0BD3GBU7BR6,BR3G3F3BU6BR4,BD2R4BD2L4BE4BR3,BRF3G3BE6,BD2UER2FD2L2DBD2U0BU6BR5,R4D4L2U2R2BD4L4U6BR712030 DATA BDD5U2R4D2U5HL2BR6,D6R3EUHL2R2EUHL2BR6,BDD4FR2EBU4HL2BR6,D6R2E2U2H2LBR6,D3R3L3D3R4BU6L4BR7,D6U3R3L3U3R4BR3,BDD4FR2EU2L2R2BU2HL2BR6,D6U3R4D3U6BR3,R4L2D6L2R4BU6BR3,BD4DFR2EU5BR3,D6U3RF3H3E3BR3,D6R4BU6BR3,D6U5RFDUERD5U6BR312040 DATA D6U5RFD2F2U6BR3,BDD4FR2EU4HL2BR6,D6U3R3EUHL2BR6,BDD4FREHF2HEU3HL2BR6,D6U4F4H3R2EUHL2BR6,BDDFR2FDGL2HBE4HL2BR6,R2D6U6R2BR3,D6R4U6BR3,D3FDFEUEU3BR3,D5FEUDFEU5BR3,DF4DBL4UE4UBR3,DFDFD2U2EUEUBR3,R4DG4DR4BU6BR312050 DATA BRR2L2D6R2BU6BR4,BD8LR6BU8BR2,BRR2D6L2BE6,BD2E2D6U6F2BU2BR3,BL7,BR712060 DATA BD2R3FD3L3HER3BU4BR3,D6R3EU2HL2BU2BR6,BD3D2FR2EBU2HL2BU2BR6,BD3D2FR3U4L3R3U2BR3,BD3DR4UHL2GD2FR3BU6BR3,BD3R3L2D3U5ERFBEBR2,BD3D2FR3DGL3BR4BUU5L3R3BU2BR3,D6U4R3FD3BU6BR3,BDBR2D0BD2D3BU6BR5,BD7FR2EU4BU2U0BUBR3,D6U3F3H2E2BU2BR412070 DATA BR2D6RBU6BR4,BD2D4U4R2D4U4RFD3BU6BR3,BD2D4U4R3FD3BU6BR3,BD3D2FR2EU2HL2BU2BR6,BD2D6U2R3EU2HL2BU2BR6,BD3D2FR3D2U6L3BU2BR6,BD2D4U2E2R2BU2BR3,BD3FR2FGL3BE4L3BU2BR6,BD2R2LU2D5FEBU5BR4,BD2D3FR2EU3BU2BR3,BD2DFDFEUEUBU2BR3,BD2D3FEUDFEU3BU2BR312080 DATA BD2F4H2G2E4BU2BR3,BD2DFDFG2E3UEUBU2BR3,BD2R4G4R4BU6BR313000 DATA0,3,12,15,48,51,60,63,192,195,204,207,240,243,252,255